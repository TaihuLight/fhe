Description: DoS via malformed XML (CVE-2009-3720)
Origin: http://expat.cvs.sourceforge.net/viewvc/expat/expat/lib/xmltok_impl.c?r1=1.15&r2=1.13

diff -Nur xmlrpc-c-1.06.27/lib/expat/xmltok/xmltok_impl.c xmlrpc-c-1.06.27.new/lib/expat/xmltok/xmltok_impl.c
--- xmlrpc-c-1.06.27/lib/expat/xmltok/xmltok_impl.c	2006-07-11 21:00:38.000000000 -0500
+++ xmlrpc-c-1.06.27.new/lib/expat/xmltok/xmltok_impl.c	2010-01-26 12:55:26.395172892 -0600
@@ -1737,7 +1737,7 @@
 			    const char *end,
 			    POSITION *pos)
 {
-  while (ptr != end) {
+  while (ptr < end) {
     switch (BYTE_TYPE(enc, ptr)) {
 #define LEAD_CASE(n) \
     case BT_LEAD ## n: \
