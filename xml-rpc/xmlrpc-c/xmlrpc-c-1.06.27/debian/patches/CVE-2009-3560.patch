Description: DoS via XML document with malformed UTF-8 sequences
 (CVE_2009_3560)
Origin: http://expat.cvs.sourceforge.net/viewvc/expat/expat/lib/xmlparse.c?r1=1.164&r2=1.166
  http://expat.cvs.sourceforge.net/viewvc/expat/expat/lib/xmlparse.c?view=log#rev1.166
  http://expat.cvs.sourceforge.net/viewvc/expat/expat/lib/xmlparse.c?view=log#rev1.165

diff -Nur xmlrpc-c-1.06.27/lib/expat/xmlparse/xmlparse.c xmlrpc-c-1.06.27.new/lib/expat/xmlparse/xmlparse.c
--- xmlrpc-c-1.06.27/lib/expat/xmlparse/xmlparse.c	2007-01-10 19:08:53.000000000 -0600
+++ xmlrpc-c-1.06.27.new/lib/expat/xmlparse/xmlparse.c	2010-01-26 12:56:33.885170530 -0600
@@ -2330,6 +2330,9 @@
         return XML_ERROR_UNCLOSED_TOKEN;
       case XML_TOK_PARTIAL_CHAR:
         return XML_ERROR_PARTIAL_CHAR;
+      case -XML_TOK_PROLOG_S:
+        tok = -tok;
+        break;
       case XML_TOK_NONE:
 #ifdef XML_DTD
         if (enc != encoding)
